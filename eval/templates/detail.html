{% extends "base.html" %}

{% block content %}
{% load static %}
{% load na_filters %}

<h3>{{ entry.name }}</h3>
{% if entry.process_status == "WAIT_UPL" or entry.process_status == "WAIT_PROC" %}
<p>&nbsp;&#8634; <i>{{entry.get_process_status_display}}</i></p>
{% endif %}
{% if entry.process_status == "FAIL" %}
<p>&nbsp;&#x2716; <i>{{entry.get_process_status_display}}</i></p>
{% endif %}
<p>{{entry.pub_date}} &nbsp;&mdash;&nbsp; {{entry.get_visibility_display}}</p>
{% if entry.visibility == "ANON" %}
<p>Anonymous.</p>
{% elif entry.citation|length > 0 %}
<p>{{ entry.citation }}</p>
{% endif %}

{% if entry.visibility != "ANON" and entry.code_url|length > 0 %}
<p>
    Code: <a href="{{ entry.code_url }}" target="_blank" rel="noopener noreferrer">{{ entry.code_url }}</a>
</p>
{% endif %}

{% if user.is_authenticated and user.pk == entry.creator.pk %}
<nav style="padding-top:0px">
    <a href="{% url 'eval:edit' entry.id %}" style="font-size:0.8rem">Edit</a>
    <a href="{% url 'eval:delete' entry.id %}" style="font-size:0.8rem">Delete</a>
</nav>
{% endif %}

{% if entry.process_status == "SUCCESS" %}
<script defer src="https://cdn.jsdelivr.net/npm/img-comparison-slider@8/dist/index.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/img-comparison-slider@8/dist/styles.css"/>

<h4>Reconstruction</h4>
<div style="overflow-x:auto;">
    <table>
        <tr>
            {% for metric in entry.metric_fields %}
            <th>{{ metric.verbose_name }}</th>
            {% endfor %}
        </tr>
        <tr>
            {% for metric in entry.metrics %}
            <td>{{ metric|na_if_missing:3 }}</td>
            {% endfor %}
        </tr>
    </table>
</div>
</br>
<div class="auto-grid">
    {% for path in image_paths %}
        <img-comparison-slider>
        <figure slot="first" class="before">
            <img slot="first" src="{% static 'samples' %}/{{ prefix }}/{{ path }}" />
            <figcaption>Ground Truth</figcaption>
        </figure>
        <figure slot="second" class="after">
            <img slot="second" src="{% get_media_prefix %}{{ samples_dir }}/{{ path }}" />
            <figcaption>Reconstruction</figcaption>
        </figure>
        </img-comparison-slider>
    {% endfor %}
</div>
{% endif %}

{% endblock %}