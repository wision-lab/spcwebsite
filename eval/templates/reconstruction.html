{% extends "base.html" %}
{% load na_filters %}

{% block content %}

{% if entries %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<h4>Reconstruction Results</h4>
{% if user.is_verified %}
    <p style="margin-bottom:0;">Results marked with a ðŸš« are private and are only be visible to you.</p>
{% endif %}
<div style="overflow-x:auto;">
<table>
    <tr>
        <th style="width:0;"></th>
        <th style="min-width: 30ch;">Name</th>
        
        {% for metric in metric_fields %}
        <th class="{% if forloop.counter0|divisibleby:3 %}leftbig{% endif %} clickable">
            <a href="{% url 'eval:reconstruction' %}?sortby={% if direction and sortby == metric.name %}-{% endif %}{{ metric.name }}">
                <p style="display: inline;">{{ metric.verbose_name|linebreaksbr }}</p>
                <span style="display: inline;">{% if sortby == metric.name %}{% if not direction %}â–²{% else %}â–¼{% endif %}{% endif %}</span>
            </a>
        </th>
        {% endfor %}
    </tr>

    {% for entry in entries %}
    <tr>
        <td>
            {{ forloop.counter }}
            {% if entry.visibility == "PRIV" %}&nbsp;<span style="font-size: small;">ðŸš«</span>{% endif %}
        </td>
        <td>
            <div class="namebox">
                <span>
                    <a href="{% url 'eval:detail' entry.id %}">{{ entry.name }}</a>
                </span>
                {% if entry.visibility != "ANON" and entry.code_url|length > 0 %}
                    &nbsp;<a href="{{ entry.code_url }}" target="_blank" rel="noopener noreferrer" class="codebutton">code</a>
                {% endif %}
            </div>
        </td>
        {% for metric in entry.metrics %}
        <td class="num {% if forloop.counter0|divisibleby:3 %}leftbig{% endif %}">{{ metric|na_if_missing:3 }}</td>
        {% endfor %}
    </tr>
    <tr>
        <td class="citation"></td>
        <td class="citation" colspan="{{ metric_fields|length|add:1 }}" style="max-width: 1vw; overflow-x: clip; text-overflow: ellipsis;">
            {% if entry.visibility == "ANON" %}
                Anonymous.
            {% else %}
                {% if entry.citation|length > 0 %}
                    {{ entry.citation }}
                {% else %}
                    &nbsp;
                {% endif %}
            {% endif %}
        </td>
    </tr>
    {% endfor %}
    
</table>
</div>
{% else %}
<p>No data available.</p>
{% endif %}
{% endblock %}