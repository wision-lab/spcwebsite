{% extends "base.html" %}
{% load static %}

{% block extra_head %}
<script defer src="https://cdn.jsdelivr.net/npm/img-comparison-slider@8/dist/index.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/img-comparison-slider@8/dist/styles.css" />
<script defer src="{% static 'img-slider.js' %}"></script>
{% endblock %}

{% block content %}
{% load static %}
{% load custom_filters %}

<h3>
    <a href="{% url 'eval:detail' entry_1.id %}">{{ entry_1.name }}</a> vs. <a
        href="{% url 'eval:detail' entry_2.id %}">{{ entry_2.name }}</a>&nbsp;&nbsp;
    <small>
        <a href="{% url 'eval:compare' entry_2.id entry_1.id %}" style="text-decoration:none">üîÑ</a>
        <a href="{% url 'eval:compare' %}" style="text-decoration:none">üé≤</a>
    </small>
</h3>

<div style="overflow-x:auto;">
    <table>
        <tr>
            <th style="width:0;">#</th>
            <th style="min-width: 30ch;">Name</th>
            {% for metric in entry_1.metric_fields %}
            <th>{{ metric.verbose_name }}</th>
            {% endfor %}
        </tr>
        <tr>
            <td>1</td>
            <td>
                <div class="namebox">
                    <span>
                        {% if entry_1.visibility == "PRIV" %}
                        <span style="font-size: small;">
                            {% if entry_1.creator.id != user.id %}ü•∏{% else %}üö´{% endif %}
                        </span>&nbsp;
                        {% endif %}
                        <a href="{% url 'eval:detail' entry_1.id %}">{{ entry_1.name }}</a>
                    </span>
                    {% if entry.visibility != "ANON" and entry.code_url|length > 0 %}
                    &nbsp;<a href="{{ entry_1.code_url }}" target="_blank" rel="noopener noreferrer"
                        class="codebutton">code</a>
                    {% endif %}
                </div>
            </td>
            {% for metric, emph in entry_1.metrics|zip:emphasis %}
            {% if emph %}
            <td><u>{{ metric|na_if_missing:3 }}</u></td>
            {% else %}
            <td>{{ metric|na_if_missing:3 }}</td>
            {% endif %}
            {% endfor %}
        </tr>
        <tr>
            <td>2</td>
            <td>
                <div class="namebox">
                    <span>
                        {% if entry_2.visibility == "PRIV" %}
                        <span style="font-size: small;">
                            {% if entry_2.creator.id != user.id %}ü•∏{% else %}üö´{% endif %}</span>&nbsp;{% endif %}
                        <a href="{% url 'eval:detail' entry_2.id %}">{{ entry_2.name }}</a>
                    </span>
                    {% if entry.visibility != "ANON" and entry.code_url|length > 0 %}
                    &nbsp;<a href="{{ entry_2.code_url }}" target="_blank" rel="noopener noreferrer"
                        class="codebutton">code</a>
                    {% endif %}
                </div>
            </td>
            {% for metric, emph in entry_2.metrics|zip:emphasis %}
            {% if not emph %}
            <td><u>{{ metric|na_if_missing:3 }}</u></td>
            {% else %}
            <td>{{ metric|na_if_missing:3 }}</td>
            {% endif %}
            {% endfor %}
        </tr>
    </table>
</div>
</br>
<div class="auto-grid">
    {% for path in image_subpaths %}
    <img-comparison-slider data-gt="{% get_static_prefix %}{{ gt_dir }}/{{ path }}">
        <figure slot="first" class="before">
            <img slot="first" src="{% get_media_prefix %}{{ samples_dir_1 }}/{{ path }}"
                data-original="{% get_media_prefix %}{{ samples_dir_1 }}/{{ path }}" />
            <figcaption>#1</figcaption>
        </figure>
        <figure slot="second" class="after">
            <img slot="second" src="{% get_media_prefix %}{{ samples_dir_2 }}/{{ path }}"
                data-original="{% get_media_prefix %}{{ samples_dir_2 }}/{{ path }}" />
            <figcaption>#2</figcaption>
        </figure>
    </img-comparison-slider>
    {% endfor %}
</div>

<div class="shortcuts-footer">
    <b>Keyboard Shortcuts:</b>
    &nbsp;&nbsp; <b>[F]</b> to enlarge preview
    &nbsp;&nbsp; &bull; &nbsp;&nbsp; <b>[‚Üë]</b>/<b>[‚Üì]</b> to cycle through images
    &nbsp;&nbsp; &bull; &nbsp;&nbsp; <b>[‚Üê]</b>/<b>[‚Üí]</b> to move the slider
    &nbsp;&nbsp; &bull; &nbsp;&nbsp; <b>[Esc]</b> to close
    <p>Press and hold <b>[1]</b> or <b>[2]</b> to temporarily replace the corresponding image with the ground truth for
        easier comparison.</p>
</div>


{% endblock %}