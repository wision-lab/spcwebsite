{% extends "base.html" %}

{% block content %}

<h3>Submission</h3>
{% if user.can_upload %}
  <div style="text-align:center; margin: 1.5rem 0;">
    <a href="{% url 'eval:submit' %}" class="btn-primary btn-lg" style="
        display: inline-block;
        background-color: #007bff;
        color: #fff;
        font-size: 1.25rem;
        font-weight: 600;
        text-decoration: none;
        padding: 0.75rem 1.5rem;
        border-radius: 0.375rem;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        transition: background-color 0.2s, box-shadow 0.2s;
      " onmouseover="this.style.backgroundColor='#0056b3'; this.style.boxShadow='0 6px 8px rgba(0,0,0,0.15)';"
      onmouseout="this.style.backgroundColor='#007bff'; this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">
      Create New Submission
    </a>
  </div>
{% else %}
  <div style="text-align:center; margin: 1.5rem 0;">
    <a style="
        display: inline-block;
        background-color: #6c757d;
        color: #fff;
        font-size: 1.25rem;
        font-weight: 600;
        text-decoration: none;
        padding: 0.75rem 1.5rem;
        border-radius: 0.375rem;
      "><strike>Create New Submission</strike></a>
  </div>
  {% if not user.can_upload %}
    {% if not user.is_verified %}
    <form method="post" action="{% url 'core:resend' %}">
      <p>You need to verify your email before being able to submit! Please also check your spam folder.</p> 
      {% csrf_token %}
      <input type="submit" value="Resend confirmation email">
      <input type="hidden" name="next" value="{{ next }}">
    </form>
    {% elif not uploads_enabled %}
      <center>
        <p style="color: red;">Submissions are currently disabled. Please try again later.</p> 
      </center>    
    {% else %}
      <center>
        <p style="color: red;">You've reached the maximum allowable daily uploads. Please try again later.</p> 
      </center>
    {% endif %}
  {% endif %}
{% endif %}

<div style="display: flex; align-items: center; gap: 10px; margin-top: 2.5rem; margin-bottom: 1.5rem;">
  <h3 style="margin: 0;">Your Submissions</h3>
  {% if entries_list %}
  <a href="{% url 'eval:reconstruction' %}?creator={{ user.id }}" class="badge" title="View your results on the leaderboard" style="padding: 0.4rem 0.6rem;">
    Leaderboard <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" style="margin-left: 4px; vertical-align: middle;"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg>
  </a>
  {% endif %}
</div>

{% if entries_list %}
{% for entry in entries_list %}
<p style="margin-bottom:6px;">
  {% if entry.process_status == "SUCCESS" %}
  <b><a href="{% url 'eval:detail' entry.id %}">{{entry.name}}</a></b>
  {% elif entry.process_status == "WAIT_UPL" or entry.process_status == "WAIT_PROC" %}
  <b>{{entry.name}}</b>
  </br>
  &#8634; <i>{{entry.get_process_status_display}}</i>
  {% elif entry.process_status == "FAIL"%}
  <b>{{entry.name}}</b>
  </br>
  &#x2716; <i>{{entry.get_process_status_display}}</i>
  {% endif %}
  &nbsp;&nbsp;
  <br>
  {{entry.pub_date}} &nbsp;&mdash;&nbsp; {{entry.get_visibility_display}}
</p>
<nav style="padding-top:0px; justify-content: left;">
  <a href="{% url 'eval:edit' entry.id %}" style="font-size:0.8rem">Edit</a>
  <a href="{% url 'eval:delete' entry.id %}" style="font-size:0.8rem">Delete</a>
</nav>
{% endfor %}
{% else %}
<p>No data available.</p>
{% endif %}

{% endblock %}